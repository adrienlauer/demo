name: ekara-demo-al
qualifier: light

ekara:
  parent:
    repository: ekara-platform/distribution
  components:
    ek-aws:
      repository: adrienlauer/aws-provider
      ref: volumes
    ek-swarm:
      repository: adrienlauer/swarm-orchestrator
      ref: no-volumes-ansible
    visualizer:
      repository: ekara-platform/swarm-visualizer-stack

nodes:
  '*':
    provider:
      name: ek-aws
      params:
        securityGroups:
          app:
            vpc_id: "vpc-880aeaef"
            rules:
              - proto: tcp
                ports:
                  - {{ .Vars.app.visualizer.port }} 
                cidr_ip: 0.0.0.0/0
                rule_desc: allow all on port {{ .Vars.app.visualizer.port }} for the swarm visualizer 
        instances:
            instance_type: "t2.micro"
        volumes:
          docker:
            ebs:
              volume_size: 1
              delete_on_termination: true
            fs:
              type: ext4
              path: /var/lib/docker

  nodeset1:
    labels:
      label1: value1
      label2: value2
    instances: 1

stacks:
  visualizer:
    component: visualizer
    templates:
      - "docker-compose.yml"
